<!doctype html>
<html><head></head><body><div><div id="boop"></div><style>
#boop {
  width: 48px;
  height: 48px;
  border: 5px solid #FFF;
  border-bottom-color: #FF3D00;
  border-radius: 50%;
  display: inline-block;
  box-sizing: border-box;
  animation: rotation 1s linear infinite;
}

@keyframes rotation {
  0% {
      transform: rotate(0deg);
  }
  100% {
      transform: rotate(360deg);
  }
} 
        </style><div><div id="arctic-app"><html><head><style>body { color: purple; }</style></head><body>hello from SPA Arctic! <a href="/test">test</a></body></html></div><script>
if (window.location.pathname !== '/') {
  go_to(new URL(window.location.href));
}
// SPA algorithm stolen from Hayleigh Thompson's wonderful Modem library
async function go_to(url, no_loader) {
  const $app = document.getElementById('arctic-app');
  if (!no_loader) $app.innerHTML = '<div id="arctic-loader"></div>';
  window.history.pushState({}, '', url.href);
  window.requestAnimationFrame(() => {
    // scroll in #-link elements, as the browser would if we didn't preventDefault
    if (url.hash) {
      document.getElementById(url.hash.slice(1))?.scrollIntoView();
    }
  });
  // handle new path
  console.log(url.pathname);
  const response = await fetch('/__pages/' + url.pathname + '/index.html');
  if (!response.ok) response = await fetch('/__pages/404.html');
  if (!response.ok) return;
  const html = await response.text();
  $app.innerHTML = html;
}
document.addEventListener('click', async function(e) {
  const a = find_a(e.target);
  if (!a) return;
  try {
    const url = new URL(a.href);
    const is_external = url.host !== window.location.host;
    if (is_external) return;
    event.preventDefault();
    go_to(url, true);
  } catch {
    return;
  }
});
function find_a(target) {
  if (!target || target.tagName === 'BODY') return null;
  if (target.tagName === 'A') return target;
  return find_a(target.parentElement);
}
  </script></div></div></body></html>